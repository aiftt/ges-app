# 脚本目录

本目录包含系统管理和开发所需的各类脚本。

## 数据库初始化脚本

`init-database.ts` - 初始化数据库，创建基础数据。

### 功能

- 创建基本用户（管理员和测试用户）
- 创建角色（管理员角色和普通用户角色）
- 创建基础菜单结构
- 创建常用字典数据

### 使用方法

```bash
pnpm tsx scripts/init-database.ts
```

### 注意事项

- 脚本会检查数据是否已存在，不会重复创建
- 请确保MongoDB服务已启动
- 默认连接到本地MongoDB（mongodb://localhost:27017/gesApp）
- 可通过环境变量配置数据库连接：MONGODB_URI, MONGODB_DB_NAME

## Git提交脚本

`submit.js` - 规范化和简化代码提交流程。

### 功能特点

- 跨平台支持（Windows、macOS和Linux）
- 自动检查依赖并安装缺失的包
- 规范化的提交信息格式（使用commitizen）
- 提交前自动拉取最新代码避免冲突
- 支持选择性添加文件
- 提交前**强制**运行代码检查（lint），确保代码质量
- 提交前可选运行测试
- 提供详细的操作反馈和错误提示

### 基本用法

```bash
pnpm submit
```

此命令将执行完整的提交流程：拉取最新代码、添加所有更改、运行检查和测试、提交并推送到远程仓库。

### 命令行参数

脚本支持以下命令行参数：

| 参数                      | 说明               |
| ------------------------- | ------------------ |
| `--help`, `-h`            | 显示帮助信息       |
| `--skip-pull`             | 跳过从远程拉取代码 |
| `--skip-test`             | 跳过测试           |
| `--selective`             | 选择性添加文件     |
| `--no-push`               | 不推送到远程仓库   |
| `--force`                 | 忽略警告继续执行   |
| `--branch`, `-b <分支名>` | 指定要提交的分支   |

## MongoDB数据库探索脚本

`explore-mongodb.ts` - 用于查看和检查MongoDB数据库中的数据。

### 功能

- 列出所有集合
- 查看集合中的文档
- 执行自定义查询

### 使用方法

```bash
pnpm tsx scripts/explore-mongodb.ts
```

### 输出说明

脚本运行后，将输出以下信息：

1. 所有可用的数据库列表及其大小
2. 当前数据库中的所有集合
3. 每个集合的文档数量
4. 每个集合的文档结构（基于第一个文档）
5. 每个集合的索引信息
6. 每个集合的示例文档

### 故障排除

如果遇到连接问题，请检查：

1. 连接字符串是否正确
2. MongoDB服务是否正在运行
3. 网络连接是否正常
4. 用户是否有权限访问数据库

### 安全注意事项

- 不要将包含敏感信息的连接字符串提交到版本控制系统
- 使用 `.env` 文件管理敏感配置，并确保 `.env` 已添加到 `.gitignore`
- 对于生产环境，确保使用最小权限原则的数据库用户
