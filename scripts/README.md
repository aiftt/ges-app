# 数据库脚本使用说明

本目录包含与数据库操作相关的实用脚本。

## 数据库结构探索脚本

`explore-mongodb.ts` 脚本用于连接MongoDB数据库并探索其结构，包括：

- 列出所有数据库
- 显示指定数据库中的所有集合
- 分析每个集合的文档结构
- 显示集合的索引信息
- 展示每个集合的示例文档

### 使用方法

1. 首先确保在项目根目录的 `.env` 文件中设置了MongoDB连接字符串：

```
MONGODB_URI=mongodb://用户名:密码@主机:端口/数据库名
```

2. 运行脚本：

```bash
# 使用npm
npm run explore-db

# 使用pnpm
pnpm explore-db
```

3. 如果不想通过环境变量设置连接字符串，可以直接修改脚本中的默认值：

```typescript
const MONGODB_URI = process.env.MONGODB_URI || 'mongodb://用户名:密码@主机:端口/数据库名';
```

### 输出说明

脚本运行后，将输出以下信息：

1. 所有可用的数据库列表及其大小
2. 当前数据库中的所有集合
3. 每个集合的文档数量
4. 每个集合的文档结构（基于第一个文档）
5. 每个集合的索引信息
6. 每个集合的示例文档

### 故障排除

如果遇到连接问题，请检查：

1. 连接字符串是否正确
2. MongoDB服务是否正在运行
3. 网络连接是否正常
4. 用户是否有权限访问数据库

### 安全注意事项

- 不要将包含敏感信息的连接字符串提交到版本控制系统
- 使用 `.env` 文件管理敏感配置，并确保 `.env` 已添加到 `.gitignore`
- 对于生产环境，确保使用最小权限原则的数据库用户
