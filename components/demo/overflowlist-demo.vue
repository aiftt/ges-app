<script setup lang="ts">
/**
 * æŠ˜å åˆ—è¡¨ç»„ä»¶æ¼”ç¤º
 * åˆ›å»ºæ—¥æœŸ: 2024-07-19
 * ä½œè€…: aiftt
 * æ›´æ–°æ—¥æœŸ: 2024-07-19 - åˆå§‹å®ç°
 * 2024-07-22 - æ·»åŠ å‚ç›´æ–¹å‘æŠ˜å æŒ‰é’®åœ¨é¡¶éƒ¨çš„ç¤ºä¾‹
 */
import { ref } from 'vue'

// å®šä¹‰æ¼”ç¤ºç”¨æ•°æ®
const tags = ref([
  'å‰ç«¯å¼€å‘',
  'åç«¯å¼€å‘',
  'UIè®¾è®¡',
  'DevOps',
  'äº§å“ç»ç†',
  'æ•°æ®åˆ†æ',
  'äººå·¥æ™ºèƒ½',
  'æœºå™¨å­¦ä¹ ',
  'äº‘è®¡ç®—',
  'ç½‘ç»œå®‰å…¨',
  'Java',
  'TypeScript',
  'Python',
  'Rust',
  'Go',
])

const users = ref([
  { id: 1, name: 'å¼ ä¸‰', avatar: 'ğŸ‘¨â€ğŸ’¼' },
  { id: 2, name: 'æå››', avatar: 'ğŸ‘©â€ğŸ’¼' },
  { id: 3, name: 'ç‹äº”', avatar: 'ğŸ‘¨â€ğŸ’»' },
  { id: 4, name: 'èµµå…­', avatar: 'ğŸ‘©â€ğŸ’»' },
  { id: 5, name: 'é’±ä¸ƒ', avatar: 'ğŸ‘¨â€ğŸ”§' },
  { id: 6, name: 'å­™å…«', avatar: 'ğŸ‘©â€ğŸ”¬' },
  { id: 7, name: 'å‘¨ä¹', avatar: 'ğŸ‘¨â€ğŸš€' },
  { id: 8, name: 'å´å', avatar: 'ğŸ‘©â€ğŸš€' },
])

// æ·»åŠ å¤æ‚åˆ—è¡¨é¡¹çš„æ•°æ®
const articles = ref([
  {
    id: 1,
    title: 'å¦‚ä½•é«˜æ•ˆä½¿ç”¨Vue3ç»„åˆå¼API',
    summary: 'Vue3çš„ç»„åˆå¼APIä¸ºå¼€å‘è€…æä¾›äº†æ›´çµæ´»çš„ç»„ç»‡ä»£ç çš„æ–¹å¼ï¼Œæœ¬æ–‡è¯¦ç»†ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨Vue3çš„ç»„åˆå¼APIè¿›è¡Œé«˜æ•ˆå¼€å‘...',
    date: '2024-01-15',
    views: 1240,
  },
  {
    id: 2,
    title: 'TypeScripté«˜çº§ç±»å‹ä½“æ“å®æˆ˜',
    summary: 'æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥äº†è§£TypeScriptçš„é«˜çº§ç±»å‹ç³»ç»Ÿï¼ŒåŒ…æ‹¬æ¡ä»¶ç±»å‹ã€æ˜ å°„ç±»å‹ã€é€’å½’ç±»å‹ç­‰é«˜çº§ç‰¹æ€§çš„å®é™…åº”ç”¨...',
    date: '2024-02-22',
    views: 890,
  },
  {
    id: 3,
    title: 'CSS Gridå¸ƒå±€å®Œå…¨æŒ‡å—',
    summary: 'CSS Gridæ˜¯ä¸€ç§å¼ºå¤§çš„äºŒç»´å¸ƒå±€ç³»ç»Ÿï¼Œæœ¬æ–‡å°†å¸®åŠ©ä½ å…¨é¢æŒæ¡CSS Gridå¸ƒå±€ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°å¤æ‚åº”ç”¨...',
    date: '2024-03-10',
    views: 1560,
  },
  {
    id: 4,
    title: 'å‰ç«¯æ€§èƒ½ä¼˜åŒ–æœ€ä½³å®è·µ',
    summary: 'æœ¬æ–‡æ€»ç»“äº†å‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„å¤šç§æŠ€æœ¯å’Œæ–¹æ³•ï¼ŒåŒ…æ‹¬èµ„æºåŠ è½½ä¼˜åŒ–ã€æ¸²æŸ“æ€§èƒ½ä¼˜åŒ–ã€ä»£ç åˆ†å‰²ç­‰å¤šç§ç­–ç•¥...',
    date: '2024-04-05',
    views: 2100,
  },
  {
    id: 5,
    title: 'WebAssemblyå…¥é—¨ä¸åº”ç”¨',
    summary: 'WebAssemblyæ­£åœ¨æ”¹å˜Webåº”ç”¨çš„æ€§èƒ½è¾¹ç•Œï¼Œæœ¬æ–‡ä»‹ç»äº†WebAssemblyçš„åŸºç¡€çŸ¥è¯†å’Œåœ¨å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨æ–¹æ³•...',
    date: '2024-05-18',
    views: 780,
  },
  {
    id: 6,
    title: 'å¾®å‰ç«¯æ¶æ„å®è·µæŒ‡å—',
    summary: 'å¾®å‰ç«¯ä¸ºå¤§å‹å‰ç«¯åº”ç”¨æä¾›äº†ä¸€ç§å¯æ‰©å±•çš„è§£å†³æ–¹æ¡ˆï¼Œæœ¬æ–‡åˆ†äº«äº†å¾®å‰ç«¯æ¶æ„çš„è®¾è®¡æ€è·¯å’Œå®è·µç»éªŒ...',
    date: '2024-06-30',
    views: 1320,
  },
])

// å¤„ç†"æ›´å¤š"ç‚¹å‡»
function handleOverflowClick(hiddenItems: any[]) {
  if (Array.isArray(hiddenItems)) {
    console.warn(`éšè—äº† ${hiddenItems.length} ä¸ªé¡¹ç›®`)
  }
}

// å¯è§æ€§å˜åŒ–å¤„ç†
function handleVisibilityChange(visibleItems: any[], hiddenItems: any[]) {
  console.warn('å¯è§é¡¹:', visibleItems.length, 'éšè—é¡¹:', hiddenItems.length)
}

// æ˜¾ç¤ºçš„å®½åº¦
const demoWidth = ref('100%')

// æ”¹å˜å®¹å™¨å®½åº¦
function changeContainerWidth(width: string) {
  demoWidth.value = width
}
</script>

<template>
  <div>
    <h2 class="mb-6 text-xl font-bold">
      æŠ˜å åˆ—è¡¨ OverflowList
    </h2>

    <!-- æ§åˆ¶é¢æ¿ -->
    <div class="mb-6 flex gap-4">
      <button
        v-for="width in ['100%', '80%', '60%', '40%', '20%']"
        :key="width"
        class="border border-gray-300 rounded px-3 py-1 text-sm transition hover:bg-gray-100"
        :class="{ 'bg-blue-100 border-blue-500': demoWidth === width }"
        @click="changeContainerWidth(width)"
      >
        å®½åº¦: {{ width }}
      </button>
    </div>

    <!-- åŸºç¡€ç”¨æ³• -->
    <section class="mb-8">
      <h3 class="mb-4 text-lg font-medium">
        åŸºç¡€ç”¨æ³•
      </h3>
      <div :style="{ width: demoWidth }" class="mb-6 border border-gray-200 rounded bg-gray-50 p-4 transition-all">
        <ui-overflowlist
          :items="tags"
          :min-visible-items="3"
          overflow-text="+ æ›´å¤šæ ‡ç­¾"
          :min-item-width="60"
          :expand-on-click="true"
          @overflow-click="handleOverflowClick"
          @visibility-change="handleVisibilityChange"
        >
          <template #item="{ item }">
            <div class="rounded-full bg-blue-100 px-3 py-1 text-sm text-blue-800">
              {{ item }}
            </div>
          </template>
        </ui-overflowlist>
      </div>
      <p class="text-sm text-gray-600">
        å½“ç©ºé—´ä¸è¶³æ—¶ï¼Œè‡ªåŠ¨éšè—éƒ¨åˆ†é¡¹ç›®å¹¶æ˜¾ç¤º"æ›´å¤š"æŒ‰é’®ã€‚ç‚¹å‡»"æ›´å¤š"æŒ‰é’®å±•å¼€å…¨éƒ¨ï¼Œå†æ¬¡ç‚¹å‡»æ”¶èµ·ã€‚
      </p>
    </section>

    <!-- å¼€å¤´æ˜¾ç¤ºæ›´å¤š -->
    <section class="mb-8">
      <h3 class="mb-4 text-lg font-medium">
        å¼€å¤´æ˜¾ç¤ºæ›´å¤š
      </h3>
      <div :style="{ width: demoWidth }" class="mb-6 border border-gray-200 rounded bg-gray-50 p-4 transition-all">
        <ui-overflowlist
          :items="tags"
          :min-visible-items="3"
          :min-item-width="60"
          overflow-position="start"
          overflow-text="æ›´å¤šæ ‡ç­¾ +"
          :expand-on-click="true"
          @overflow-click="handleOverflowClick"
        >
          <template #item="{ item }">
            <div class="rounded-full bg-green-100 px-3 py-1 text-sm text-green-800">
              {{ item }}
            </div>
          </template>
        </ui-overflowlist>
      </div>
    </section>

    <!-- è‡ªå®šä¹‰æ ·å¼ -->
    <section class="mb-8">
      <h3 class="mb-4 text-lg font-medium">
        è‡ªå®šä¹‰æ ·å¼
      </h3>
      <div :style="{ width: demoWidth }" class="mb-6 border border-gray-200 rounded bg-gray-50 p-4 transition-all">
        <ui-overflowlist
          :items="users"
          item-key="id"
          :min-visible-items="2"
          :min-item-width="100"
          overflow-text="æ›´å¤šç”¨æˆ·"
          :gap="16"
          :expand-on-click="true"
          item-class="border border-gray-200 rounded-lg p-2 bg-white"
          overflow-class="bg-purple-600 text-white px-3 py-2 rounded-lg"
          @overflow-click="handleOverflowClick"
        >
          <template #item="{ item }">
            <div class="flex items-center gap-2">
              <span class="text-xl">{{ item.avatar }}</span>
              <span>{{ item.name }}</span>
            </div>
          </template>
          <template #overflow="{ hiddenItems }">
            <div class="flex items-center gap-2">
              <span>+{{ hiddenItems.length }} äºº</span>
            </div>
          </template>
        </ui-overflowlist>
      </div>
    </section>

    <!-- ç‚¹å‡»å±•å¼€ -->
    <section class="mb-8">
      <h3 class="mb-4 text-lg font-medium">
        æ°´å¹³æ–¹å‘å±•å¼€æ•ˆæœ
      </h3>
      <div :style="{ width: demoWidth }" class="mb-6 border border-gray-200 rounded bg-gray-50 p-4 transition-all">
        <ui-overflowlist
          :items="tags"
          :min-visible-items="3"
          :min-item-width="60"
          overflow-text="+ æ›´å¤šæ ‡ç­¾"
          collapse-text="æ”¶èµ·æ ‡ç­¾"
          :expand-on-click="true"
          @overflow-click="handleOverflowClick"
        >
          <template #item="{ item }">
            <div class="rounded-full bg-blue-100 px-3 py-1 text-sm text-blue-800">
              {{ item }}
            </div>
          </template>
          <template #overflow="{ hiddenItems, isExpanded }">
            <div class="flex items-center justify-center gap-2">
              {{ isExpanded ? 'æ”¶èµ·æ ‡ç­¾' : `+${hiddenItems.length} æ ‡ç­¾` }}
              <ui-icon :icon="isExpanded ? 'carbon:chevron-up' : 'carbon:chevron-down'" />
            </div>
          </template>
        </ui-overflowlist>
      </div>
      <p class="text-sm text-gray-600">
        ç‚¹å‡»"æ›´å¤š"æŒ‰é’®å±•å¼€æ‰€æœ‰æ ‡ç­¾é¡¹ï¼Œæ ‡ç­¾å°†è‡ªåŠ¨æ¢è¡Œæ˜¾ç¤ºï¼Œç¡®ä¿æ‰€æœ‰å†…å®¹å¯è§ã€‚å†æ¬¡ç‚¹å‡»æ”¶èµ·ã€‚
      </p>
    </section>

    <!-- å‚ç›´æ–¹å‘å¸ƒå±€ -->
    <section class="mb-8">
      <h3 class="mb-4 text-lg font-medium">
        å‚ç›´æ–¹å‘å¸ƒå±€
      </h3>
      <div :style="{ width: demoWidth }" class="mb-6 border border-gray-200 rounded bg-gray-50 p-4 transition-all">
        <ui-overflowlist
          :items="articles"
          item-key="id"
          :min-visible-items="2"
          direction="vertical"
          max-height="300px"
          :expand-on-click="true"
          overflow-text="æ˜¾ç¤ºæ›´å¤šæ–‡ç« "
          collapse-text="æ”¶èµ·æ–‡ç« åˆ—è¡¨"
          @overflow-click="handleOverflowClick"
        >
          <template #item="{ item }">
            <div class="mb-2 rounded-lg bg-white p-4 shadow-sm transition-shadow hover:shadow">
              <div class="mb-2 flex items-start justify-between">
                <h4 class="text-lg text-gray-900 font-medium">
                  {{ item.title }}
                </h4>
                <span class="text-sm text-gray-500">{{ item.date }}</span>
              </div>
              <p class="mb-3 text-gray-700">
                {{ item.summary }}
              </p>
              <div class="flex items-center justify-between">
                <span class="text-sm text-gray-500">é˜…è¯»é‡: {{ item.views }}</span>
                <button class="text-sm text-blue-600 hover:text-blue-800">
                  é˜…è¯»å…¨æ–‡
                </button>
              </div>
            </div>
          </template>
          <template #overflow="{ hiddenItems, isExpanded }">
            <div class="flex items-center justify-center gap-2 rounded-lg bg-blue-50 px-4 py-2 text-blue-600 transition-colors hover:bg-blue-100">
              <span>{{ isExpanded ? 'æ”¶èµ·æ–‡ç« åˆ—è¡¨' : `æ˜¾ç¤ºæ›´å¤š ${hiddenItems.length} ç¯‡æ–‡ç« ` }}</span>
              <ui-icon :icon="isExpanded ? 'carbon:chevron-up' : 'carbon:chevron-down'" />
            </div>
          </template>
        </ui-overflowlist>
      </div>
      <p class="text-sm text-gray-600">
        å‚ç›´æ–¹å‘çš„æŠ˜å åˆ—è¡¨ï¼Œé€‚ç”¨äºæ–‡ç« åˆ—è¡¨ã€è¯„è®ºåˆ—è¡¨ç­‰å æ®æ•´è¡Œçš„å†…å®¹ã€‚ç‚¹å‡»"æ˜¾ç¤ºæ›´å¤š"æŒ‰é’®å±•å¼€å…¨éƒ¨ï¼Œå†æ¬¡ç‚¹å‡»æ”¶èµ·ã€‚
      </p>
    </section>

    <!-- å‚ç›´æ–¹å‘å¸ƒå±€ - é¡¶éƒ¨æŠ˜å æŒ‰é’® -->
    <section class="mb-8">
      <h3 class="mb-4 text-lg font-medium">
        å‚ç›´æ–¹å‘å¸ƒå±€ - é¡¶éƒ¨æŠ˜å æŒ‰é’®
      </h3>
      <div :style="{ width: demoWidth }" class="mb-6 border border-gray-200 rounded bg-gray-50 p-4 transition-all">
        <ui-overflowlist
          :items="articles"
          item-key="id"
          :min-visible-items="2"
          direction="vertical"
          overflow-position="start"
          max-height="300px"
          :expand-on-click="true"
          overflow-text="å±•å¼€æ–‡ç« åˆ—è¡¨"
          collapse-text="æ”¶èµ·æ–‡ç« åˆ—è¡¨"
          @overflow-click="handleOverflowClick"
        >
          <template #item="{ item }">
            <div class="mb-2 rounded-lg bg-white p-4 shadow-sm transition-shadow hover:shadow">
              <div class="mb-2 flex items-start justify-between">
                <h4 class="text-lg text-gray-900 font-medium">
                  {{ item.title }}
                </h4>
                <span class="text-sm text-gray-500">{{ item.date }}</span>
              </div>
              <p class="mb-3 text-gray-700">
                {{ item.summary }}
              </p>
              <div class="flex items-center justify-between">
                <span class="text-sm text-gray-500">é˜…è¯»é‡: {{ item.views }}</span>
                <button class="text-sm text-blue-600 hover:text-blue-800">
                  é˜…è¯»å…¨æ–‡
                </button>
              </div>
            </div>
          </template>
          <template #overflow="{ isExpanded }">
            <div class="flex items-center justify-center gap-2 text-amber-600 transition-colors hover:text-amber-700">
              <span>{{ isExpanded ? 'æ”¶èµ·æ–‡ç« åˆ—è¡¨' : `æŸ¥çœ‹å…¨éƒ¨ ${articles.length} ç¯‡æ–‡ç« ` }}</span>
              <ui-icon :icon="isExpanded ? 'carbon:chevron-up' : 'carbon:chevron-down'" />
            </div>
          </template>
        </ui-overflowlist>
      </div>
      <p class="text-sm text-gray-600">
        å‚ç›´æ–¹å‘æŠ˜å åˆ—è¡¨ï¼ŒæŠ˜å æŒ‰é’®ä½äºåˆ—è¡¨é¡¶éƒ¨ã€‚é€‚ç”¨äºéœ€è¦åœ¨é¡¶éƒ¨å±•ç¤º"æŸ¥çœ‹å…¨éƒ¨"æˆ–ç±»ä¼¼åŠŸèƒ½çš„åœºæ™¯ã€‚
      </p>
    </section>
  </div>
</template>
