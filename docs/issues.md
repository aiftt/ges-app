# GES UI 组件库 问题记录

本文件记录组件库开发过程中遇到的问题及其修复方法。

## 表单组件

### Input Tag 组件

#### 1. 递归更新问题

**问题描述**：删除标签时会报错 "Maximum recursive updates exceeded in component <input-tag>"

**问题原因**：在 removeTag 函数中，代码同时通过 watch 和显式调用两种方式触发了 update:modelValue 事件，导致递归更新。

**修复方案**：修改 watch 函数，避免在值相同时触发重复更新，只在值实际变化时再触发 update:modelValue 事件。

**修复时间**：2024-07-12

**状态**：已修复

#### 2. 标签颜色配置

**问题描述**：需要支持配置 ui-tag 的颜色

**修复方案**：添加动态设置Tag颜色的工具函数，基于索引或Tag内容生成不同颜色，支持通过tagColor、tagBgColor和tagTextColor属性自定义颜色。

**修复时间**：2024-07-13

**状态**：已完成

### Autocomplete 组件

#### 1. 下拉框闪现问题

**问题描述**：选择下拉框内容后下拉框会闪现一下

**问题原因**：在选择选项后，组件未防止处理 blur 事件时重新打开下拉框，且多个处理选项选择的方法实现不一致

**修复方案**：

1. 改进 ignoreBlurEvent 标记的使用，确保在选项点击时立即设置
2. 修改 handleBlur 方法，在 ignoreBlurEvent 为 true 时不关闭下拉框
3. 统一 handleOptionClick 和 selectOption 的实现逻辑

**修复时间**：2024-07-12

**状态**：已修复

#### 2. 选项分组高亮错乱问题

**问题描述**：选项分组时鼠标放到一个选项时另一个分组的也会高亮

**问题原因**：选项的key值可能重复，导致Vue无法正确区分不同选项

**修复方案**：确保每个选项使用唯一的key，包括组索引、选项值和选项索引

**修复时间**：2024-07-12

**状态**：已修复

#### 3. 选中选项后下拉框为空问题

**问题描述**：选中一个选项后，再次展开下拉框时内容为空

**问题原因**：选项过滤逻辑有问题，没有正确处理空输入值和分组选项的情况

**修复方案**：重构filteredOptions和finalOptions计算属性，优化选项过滤和分组处理逻辑

**修复时间**：2024-07-13

**状态**：已修复

### Cascader 级联选择器

#### 1. 下拉框关闭问题

**问题描述**：选择有子节点的节点时不应关闭下拉框

**问题原因**：在选择任何节点后都会直接关闭下拉框，而不是仅在选择叶子节点时关闭

**修复方案**：修改为鼠标悬停就展开子节点，单击才是选中，仅在选中叶子节点时才关闭下拉框

**修复时间**：2024-07-13

**状态**：已修复

#### 2. 滚动条问题

**问题描述**：下拉框内容超出时没有出现滚动条导致无法选中

**问题原因**：缺少必要的CSS样式设置overflow和最大高度

**修复方案**：为级联选择器面板添加overflow-y: auto和max-height样式，确保超出内容可以滚动查看

**修复时间**：2024-07-12

**状态**：已修复

#### 3. 叶子节点回显问题

**问题描述**：选中叶子节点时没有回显，选中时候下拉框就隐藏了

**问题原因**：在选中节点后立即关闭下拉框，没有正确更新选中状态

**修复方案**：修改选中逻辑，确保在关闭下拉框前正确更新选中值并触发相应事件

**修复时间**：2024-07-12

**状态**：已修复

### ColorPicker 颜色选择器

#### 1. 颜色选择问题

**问题描述**：带透明度时无法选中颜色，值变成rgba(NaN, NaN, NaN, 0.5)这种无效值

**问题原因**：颜色转换函数实现有误，未正确处理HSL/RGB/HEX格式转换和透明度

**修复方案**：

1. 重写颜色转换函数，修复HSL到RGB和HEX的转换
2. 修复拖动逻辑，确保正确计算和更新颜色值
3. 优化值格式化，确保生成有效的颜色字符串

**修复时间**：2024-07-13

**状态**：已修复

### TimePicker 时间选择器

#### 1. 下拉框关闭问题

**问题描述**：选择时间后立即关闭下拉框，应该点击确定按钮时才关闭

**问题原因**：在设置时间值时就关闭了面板，而不是等用户确认

**修复方案**：修改时间设置函数，移除直接关闭面板的代码，仅在点击确认按钮时才关闭面板

**修复时间**：2024-07-13

**状态**：已修复

### Upload 上传组件

#### 1. Demo缺失问题

**问题描述**：Upload组件已实现但未添加到组件演示页面中

**问题原因**：在实现Upload组件后，未更新组件演示页面

**修复方案**：将Upload组件添加到组件演示页面的表单组件分组中

**修复时间**：2024-07-17

**状态**：已修复

## 布局组件

### Split 面板分割

#### 1. 拖动位置问题

**问题描述**：分割位置的值没有随拖动发生变化

**问题原因**：未在拖动过程中更新modelValue，只在拖动结束时更新了一次

**修复方案**：在handleDragMove函数中实时更新modelValue值，确保拖动过程中能够反映当前分割位置

**修复时间**：2024-07-13

**状态**：已修复

#### 2. 最小尺寸限制问题

**问题描述**：最小尺寸限制不生效

**问题原因**：最小尺寸限制的实现有误，未正确应用props.min属性

**修复方案**：修复最小尺寸限制的逻辑，确保每个面板至少有min%的空间

**修复时间**：2024-07-13

**状态**：已修复

#### 3. 分隔条样式问题

**问题描述**：拖动到最右边后拖动元素消失，导致无法继续拖动

**问题原因**：分隔条的z-index设置不正确，被其他元素覆盖或位置计算错误

**修复方案**：增加分隔条的z-index值，确保始终保持在前，优化样式以保证可见性，修复宽度/高度计算

**修复时间**：2024-07-13

**状态**：已修复

### Collapse 折叠面板

#### 1. 嵌套面板溢出问题

**问题描述**：嵌套面板时，里面嵌套的折叠面板超出了外层内容区

**问题原因**：缺少必要的overflow:hidden样式和盒模型设置

**修复方案**：

1. 为内容区添加overflow:hidden样式
2. 设置width:100%和box-sizing:border-box确保内容不会溢出
3. 为嵌套的折叠面板添加特定样式以确保正确显示

**修复时间**：2024-07-13

**状态**：已修复

## 数据展示组件

### Table 表格组件

#### 1. 排序箭头点击问题

**问题描述**：排序的两个箭头点击没反应，并且点击一个两个都会被高亮

**问题原因**：

1. 表格组件使用了单一图标表示排序状态，而不是分开的上下箭头
2. 排序状态切换逻辑只在点击整个单元格时生效，没有为单独的箭头添加点击事件

**修复方案**：

1. 将单一排序图标拆分为独立的上下箭头
2. 为每个箭头添加独立的点击事件处理函数，直接设置对应的排序状态
3. 修改排序状态切换逻辑，支持直接指定排序方向

**修复时间**：2024-07-17

**状态**：已修复

#### 2. 表格滚动条问题

**问题描述**：页面宽度发生变化时表格未显示滚动条，导致部分内容不可见

**问题原因**：

1. 表格容器的overflow样式设置不正确
2. 表格主体没有设置最小宽度

**修复方案**：

1. 为表格容器添加overflow:hidden样式
2. 为表格主体添加overflow:auto样式以显示滚动条
3. 为表格设置min-width:100%确保内容不会被压缩

**修复时间**：2024-07-17

**状态**：已修复

#### 3. 单元格tooltip问题

**问题描述**：单元格内容过长显示省略号时，没有tooltip显示完整内容

**问题原因**：虽然添加了showOverflowTooltip属性，但未实现实际的tooltip功能

**修复方案**：

1. 为带有showOverflowTooltip属性的单元格添加title属性，值为完整的单元格内容
2. 添加CSS实现鼠标悬停时显示tooltip的效果

**修复时间**：2024-07-17

**状态**：已修复

### Rate 评分组件

#### 1. 图标加载问题

**问题描述**：无法加载图标，报错"[Icon] failed to load icon `carbon:heart-filled`"

**问题原因**：使用了不存在的或不可用的图标名称

**修复方案**：将图标从'carbon:heart-filled'更改为可用的'mdi:heart'和'mdi:heart-outline'图标

**修复时间**：2024-07-16

**状态**：已修复
